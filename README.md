# symfony-go-example

## Постановка задачи
1. Php
Написать на Symfony блог приложение. В приложении есть следующие роли: автор поста, модератор и гость. Автор может создать, изменить и удалить пост. При создании или изменении поста, он попадает на модерацию, где модератор может опубликовать или вернуть на исправления (с замечаниями). Гость видит список опубликованных постов (зоголовк и описание). При каждом изменении состояния поста требуется отправлять событие в сервис аналитики (описанный в п.2). Необходимо логировать ошибочные ответы от сервиса аналитики (HTTP 500).
2. Go
Написать сервис сбора аналитики постов. Создать API эндпоинт, который будет принимать JSON-документы об изменении состояния постов. Сервис работает неидеально, поэтому время обработки каждого запроса длится 3-15сек (рандомно) и периодически отвечает 500 ответом, например для постов с ID, кратным 3. Результатом обработки сообщения должен быть HTTP ответ 200 или 500. Также выводить в терминал JSON, время обработки запроса и HTTP статус ответа (200, 500).
Пример сообщения:
{
    "authorId": 123,
    "postId": 123,
    "postTitle": "Test post",
    "action": "create"
}

Результат предоставить в виде ссылки на открытый Git-репозиторий.
Срок выполнения 2-3 дня.

## Описание реализации
1. Блог-приложение реализовано на Symfony 6. В приложении есть полноценная админка с авторизацией.

Предустановлены 4 юзера:
- "author1" (пароль "12345678")
- "author2" (пароль "12345678")
- "moderator" (пароль "12345678")
- "guest" (пароль "12345678")

Роуты:
- "/" (дефолтная страница Symfony, не стал менять)
- "/blog" (примитивный блог, список статей со статусом публикации)
- "/blog/post/{id}" (статья)
- "/admin" (полноценная админка)
- "/login" (форма авторизации, используется обычная http-авторизация)

Имеется 3 роли: автор поста, модератор и гость. При создании поста статус "на модерации" не проставляется автоматом (немного отступил от постановки задачи, так сделано сознательно по причине того, что создание статьи автором может происходить за несколько "подходов"), автор должен сам поменять статус с "на редактировании" (который проставляется при создании новой статьи автоматом) на статус "на модерации". Соответственно модератор пишет замечание к статье и, при необходимости, меняет статус с возвратом на доработку "на редактировании" или "на публикации".

Поскольку приложение создано в "академических" целях, полноценную базу данных развёртывать не стал, реализовал на Sqlite, файл базы лежит в папке "/data" корня проекта. 

2. Сервис сбора аналитики очень простой. Исходники лежат в папке "/go" корня проекта (там же и скомпилированный "analytics.exe", и да - я работаю под Windows). Данные логируются в консоль приложения, выставляются соответствующие таймауты и иногда (при id статьи кратном 3) клиенту (Symfony-блог) выдаётся ответ с HTTP 500 ошибкой. Данные на стороне блога в случае HTTP 500 логируются в стандартный лог. Локальный адрес сервиса http://localhost:8080/analytics (POST, без авторизации).  

3. Скриншоты
- Блог со статьями на фронте

![Блог со статьями на фронте](https://github.com/linkonoid/symfony-go-example/blob/main/images/blog.png)
- Форма авторизации

![Форма авторизации](https://github.com/linkonoid/symfony-go-example/blob/main/images/login.png)
- Админка со списком постов

![Админка со списком постов](https://github.com/linkonoid/symfony-go-example/blob/main/images/posts.png)
- Форма редактирования поста

![Форма редактирования поста](https://github.com/linkonoid/symfony-go-example/blob/main/images/detail.png)
- Консоль сервиса аналитики

![Консоль сервиса аналитики](https://github.com/linkonoid/symfony-go-example/blob/main/images/analytics.png)
